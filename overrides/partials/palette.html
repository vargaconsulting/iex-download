<form class="md-header__option" data-md-component="palette">
  {% if config.extra.social %}
    <div class="md-social-inline">
      {% macro split_and_get(value, sep, index) %}
        {%- if value.split is defined -%}
          {%- set parts = value.split(sep) -%}
        {%- else -%}
          {%- set parts = value | split(sep) -%}
        {%- endif -%}
        {{- parts[index] -}}
      {% endmacro %}
      {% for social in config.extra.social %}
        {% set rel = "noopener" %}
        {% if "mastodon" in social.icon %}
          {% set rel = rel ~ " me" %}
        {% endif %}
        {% set title = social.name %}
        {% if not title and "//" in social.link %}
          {% set url = split_and_get(social.link, "//", 1) %}
          {% set title = split_and_get(url, "/", 0) %}
        {% endif %}
        <a href="{{ social.link }}" target="_blank" rel="{{ rel }}" title="{{ title | e }}" class="md-header__button md-icon">
          {% include ".icons/" ~ social.icon ~ ".svg" %}
        </a>
      {% endfor %}

      {# ðŸ‘‡ spacer icon or gap before theme switcher #}
      <span class="md-header__button md-icon" style="pointer-events: none; opacity: 0.4;">|</span>  {# Unicode bullet as spacer #}
    </div>
  {% endif %}

  {# ðŸ‘‡ Theme switcher LAST now #}
  {% for option in config.theme.palette %}
    {% set scheme  = option.scheme  | d("default", true) %}
    {% set primary = option.primary | d("indigo", true) %}
    {% set accent  = option.accent  | d("indigo", true) %}

    <input class="md-option"
           data-md-color-media="{{ option.media }}"
           data-md-color-scheme="{{ scheme | replace(' ', '-') }}"
           data-md-color-primary="{{ primary | replace(' ', '-') }}"
           data-md-color-accent="{{ accent | replace(' ', '-') }}"
           {% if option.toggle %} aria-label="{{ option.toggle.name }}"
           {% else %} aria-hidden="true"
           {% endif %}
           type="radio" name="__palette" id="__palette_{{ loop.index0 }}">

    {% if option.toggle %}
      <label class="md-header__button md-icon"
             title="{{ option.toggle.name }}"
             for="__palette_{{ loop.index % loop.length }}">
        {% include ".icons/" ~ option.toggle.icon ~ ".svg" %}
      </label>
    {% endif %}
  {% endfor %}
</form>
